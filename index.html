{% extends "layout.html" %}

{% block content %}
<div class="card mb-4">
    <div class="card-header">
        Carregar Ficheiro Excel (.xlsx)
    </div>
    <div class="card-body">
        <form method="post" enctype="multipart/form-data">
            <div class="input-group">
                <input type="file" class="form-control" name="file" accept=".xlsx,.xls">
                <button class="btn btn-primary" type="submit">Carregar e Processar</button>
            </div>
        </form>
    </div>
</div>

{% if data %}
<div class="row">
    <div class="col-lg-6 mb-4">
        <div class="card">
            <div class="card-header">Gráfico Interativo (Chart.js)</div>
            <div class="card-body">
                <canvas id="myChart"></canvas>
            </div>
        </div>
    </div>
    <div class="col-lg-6 mb-4">
        <div class="card">
            <div class="card-header">Gráfico Estático (Matplotlib)</div>
            <div class="card-body">
                <img src="/plot.png" class="img-fluid" alt="Gráfico Matplotlib">
            </div>
        </div>
    </div>
</div>

<div class="card">
    <div class="card-header">
        Dados do Ficheiro
    </div>
    <div class="card-body" style="overflow-x:auto;">
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    {% for header in data.keys() %}
                    <th>{{ header }}</th>
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for row in data %}
                <tr>
                    {% for cell in row.values() %}
                    <td>{{ cell }}</td>
                    {% endfor %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% else %}
<div class="alert alert-info" role="alert">
    Por favor, carregue um ficheiro Excel para ver os dados e os gráficos.
</div>
{% endif %}

{% endblock %}